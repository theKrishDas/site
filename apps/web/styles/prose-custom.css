@utility prose {
  --tw-prose-body: oklch(0.375 0 0);

  @variant dark {
    --tw-prose-body: oklch(0.875 0 0);
  }

  h2 {
    @apply text-[1.1rem] -tracking-[0.005em] leading-normal font-semibold text-[oklch(0.3_0_0)] dark:text-white decoration-[1.5px];
    @apply mb-6 mt-14 md:mt-14;
    @apply scroll-mt-8;
  }

  h3 {
    @apply text-[0.9rem] font-semibold tracking-[0.01em] text-[oklch(0.3_0_0)] dark:text-white decoration-[1.5px];
    @apply mb-6 mt-12 md:mt-14;
    @apply scroll-mt-8;
  }

  p {
    @apply mb-6.5;
  }

  strong:not(.not-prose) {
    @apply font-semibold text-label-primary font-inter;
  }

  em:not(.not-prose) {
    @apply font-source-serif text-lg italic text-label-primary;
  }

  ul > li:not(.not-prose, .not-prose *) {
    @apply list-none ps-1.25;

    &::marker {
      @apply content-['-_'] text-[1.1em] leading-none font-medium text-gray-2;
    }
  }

  blockquote {
    @apply text-2xl leading-[1.33] md:text-3xl font-source-serif font-normal not-italic;

    em {
      @apply text-[1.025em];
    }
  }

  a {
    @apply decoration-separator-opaque;
  }

  code:not(.not-prose, .not-prose *) {
    @apply rounded-md px-1 py-px;
  }

  img {
    @apply rounded-[1.375rem];
    /* biome-ignore lint/correctness/noUnknownProperty: it does exisit */
    corner-shape: squircle;
  }

  figcaption {
    @apply text-center text-gray-2 text-sm text-balance;
  }

  /* Styles footnote reference numbers and backlinks with a small, rounded badge. */
  [data-footnote-ref="true"]:not(.not-prose, .not-prose *) {
    @apply select-none corner-squircle mx-0.5 inline-grid h-3.75 place-content-center rounded-md bg-fill-primary px-0.75 pt-px font-jetbrains-mono text-[0.7rem] text-label-secondary leading-none no-underline;
  }
  [data-footnote-backref]:not(.not-prose, .not-prose *) {
    @apply select-none corner-squircle mx-0.5 inline-grid h-4 align-text-top place-content-center rounded-md bg-fill-primary px-0.75 pt-px text-[0.7rem] text-label-secondary no-underline;
  }

  /* Styles for footnote lists and elements */
  ol:has(li[id^="user-content-fn-"]) {
    @apply pl-4;
  }
  li[id^="user-content-fn-"] p {
    @apply text-[0.85rem] leading-normal text-label-secondary;
    a {
      @apply text-inherit;
    }
  }
  li[id^="user-content-fn-"]::marker {
    @apply text-[0.85rem];
  }

  /**
   * ! EXPERIMENTAL - Shiki code container styles
   *
   * Required dependencies:
   * - @repo/tailwind-config/utils
   *
   * Scope: Shiki code block container elements
   */
  div[data-orientation="horizontal"]:has(figure.shiki) {
    @apply max-sm:flush-width;
  }

  figure.shiki {
    /* depends on @repo/tailwind-config/utils */
    @apply max-sm:flush-width;
  }

  /* Remove shadows from code blocks */
  pre:not(.not-fumadocs-codeblock *),
  code:not(.not-fumadocs-codeblock *),
  .shiki,
  figure.shiki,
  [data-rehype-pretty-code-fragment],
  [data-rehype-pretty-code-figure] {
    @apply shadow-none;
  }
}

.shiki:not(.not-fumadocs-codeblock *) {
  @apply shadow-none;
}

.dark .shiki:not(.not-fumadocs-codeblock *) {
  @apply shadow-none;
}

/* Additional overrides for any container elements that might have shadows */
[data-rehype-pretty-code-fragment],
[data-rehype-pretty-code-figure],
.fumadocs-codeblock,
.fumadocs-codeblock-container {
  @apply shadow-none;
}
